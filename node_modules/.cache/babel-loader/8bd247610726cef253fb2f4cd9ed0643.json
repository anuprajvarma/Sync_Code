{"ast":null,"code":"import _regeneratorRuntime from\"/Users/anupraj/Documents/Sync_Code/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/anupraj/Documents/Sync_Code/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/anupraj/Documents/Sync_Code/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from'react';import{useLocation,useNavigate,useParams}from'react-router-dom';import toast from'react-hot-toast';import{initSocket}from'./socket';import Client from'./components/Client_avatar';import logo from\"./images/logo.webp\";import Editor from'./components/Editor';import'./EditorPage.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditorPage(){var socketRef=useRef(null);var navigate=useNavigate();var codeRef=useRef(null);var location=useLocation();var data=useParams();var roomId=data.id;var username=location.state.username;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),clients=_useState2[0],setclients=_useState2[1];useEffect(function(){var init=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return initSocket();case 2:socketRef.current=_context.sent;socketRef.current.emit('join_room',{roomId:roomId,username:username});socketRef.current.on(\"joined_user\",function(_ref2){var clients=_ref2.clients,username=_ref2.username,socketId=_ref2.socketId;if(username!==location.state.username){toast.success(\"\".concat(username,\" joined the room.\"));}setclients(clients);socketRef.current.emit('sync_code',{code:codeRef.current,socketId:socketId});});socketRef.current.on('disconnected',function(_ref3){var socketId=_ref3.socketId,username=_ref3.username;toast.success(\"\".concat(username,\" left the room\"));setclients(function(prev){return prev.filter(function(clients){return clients.socketId!==socketId;});});});case 6:case\"end\":return _context.stop();}}},_callee);}));return function init(){return _ref.apply(this,arguments);};}();init();return function(){socketRef.current.disconnect();socketRef.current.off(\"disconnected\");socketRef.current.off(\"joined_user\");};},[]);function copyRoomId(){return _copyRoomId.apply(this,arguments);}function _copyRoomId(){_copyRoomId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(clients);_context2.prev=1;_context2.next=4;return window.navigator.clipboard.writeText(roomId);case 4:toast.success('Room id has been copied to clipboard!');_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](1);toast.error(_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[1,7]]);}));return _copyRoomId.apply(this,arguments);}function leaveRoom(){navigate('/');toast.success('You leaved the Room');}return/*#__PURE__*/_jsxs(\"div\",{className:\"mainWrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"aside\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"asideInner\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"logoImage\",src:logo,alt:\"\"})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Connected\"}),/*#__PURE__*/_jsx(\"div\",{className:\"clientList\",children:clients.map(function(item){return/*#__PURE__*/_jsx(Client,{username:item.username},item.socketId);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn copyBtn\",onClick:copyRoomId,children:\"Copy Room Id\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn leaveBtn\",onClick:leaveRoom,children:\"Leave\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"editorWrap\",children:/*#__PURE__*/_jsx(Editor,{socketRef:socketRef,roomId:roomId,onCodeChange:function onCodeChange(code){codeRef.current=code;}})})]});}export default EditorPage;","map":{"version":3,"names":["React","useEffect","useRef","useState","useLocation","useNavigate","useParams","toast","initSocket","Client","logo","Editor","EditorPage","socketRef","navigate","codeRef","location","data","roomId","id","username","state","clients","setclients","init","current","emit","on","socketId","success","code","prev","filter","disconnect","off","copyRoomId","console","log","window","navigator","clipboard","writeText","error","leaveRoom","map","item"],"sources":["/Users/anupraj/Documents/Sync_Code/src/EditorPage.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport { useLocation, useNavigate, useParams } from 'react-router-dom';\nimport toast from 'react-hot-toast';\nimport { initSocket } from './socket'\nimport Client from './components/Client_avatar'\nimport logo from \"./images/logo.webp\"\nimport Editor from './components/Editor';\nimport './EditorPage.css'\n\n\nfunction EditorPage() {\n    const socketRef = useRef(null)\n    const navigate = useNavigate();\n    const codeRef = useRef(null);\n    const location = useLocation();\n    const data = useParams();\n    const roomId = data.id\n    const username = location.state.username\n    const [clients, setclients] = useState([]);\n\n    useEffect(() => {\n\n        const init = async () =>{\n            socketRef.current = await initSocket();\n\n            socketRef.current.emit('join_room', { roomId, username })\n\n            socketRef.current.on(\"joined_user\", ({ clients, username, socketId }) => {\n            if (username !== location.state.username) {\n                toast.success(`${username} joined the room.`)\n            }\n            setclients(clients);\n\n            socketRef.current.emit('sync_code',{\n                code: codeRef.current,\n                socketId,\n            })\n        })\n\n        socketRef.current.on('disconnected', ({ socketId, username }) => {\n            toast.success(`${username} left the room`);\n            setclients((prev) => {\n                return prev.filter(\n                    (clients) => clients.socketId !== socketId\n                )\n            })\n        })\n        }\n        init();\n        return () => {\n            socketRef.current.disconnect();\n            socketRef.current.off(\"disconnected\")\n            socketRef.current.off(\"joined_user\")\n        }\n    }, [])\n\n\n    async function copyRoomId() {\n        console.log(clients)\n        try {\n            await window.navigator.clipboard.writeText(roomId);\n            toast.success('Room id has been copied to clipboard!')\n        } catch (err) {\n            toast.error(err);\n        }\n    }\n    function leaveRoom() {\n        navigate('/');\n        toast.success('You leaved the Room');\n    }\n\n    return (\n        <div className='mainWrap'>\n            <div className='aside'>\n                <div className='asideInner'>\n                    <div className=\"logo\">\n                        <img className=\"logoImage\" src={logo} alt=\"\" />\n                    </div>\n                    <h3>Connected</h3>\n                    <div className='clientList'> \n                        {\n                            clients.map((item) => (<Client key={item.socketId} username={item.username} />))\n                        }\n                    </div>\n                </div>\n                <div className='buttons'>\n                    <button className='btn copyBtn' onClick={copyRoomId}>Copy Room Id</button>\n                    <button className='btn leaveBtn' onClick={leaveRoom}>Leave</button>\n                </div>\n            </div>\n\n            <div className='editorWrap'>\n                <Editor socketRef={socketRef} roomId={roomId} onCodeChange={(code)=>{codeRef.current=code}}/>\n            </div>\n        </div>\n    )\n}\n\nexport default EditorPage\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}